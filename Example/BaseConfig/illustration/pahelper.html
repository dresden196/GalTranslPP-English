<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>问题分析 语法示例</title>
    <style>
        /* --- 全局样式 --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            background-color: #f4f7f9;
            color: #333;
            line-height: 1.7;
            margin: 0;
            padding: 2rem;
        }

        /* --- 容器样式 --- */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 2rem 2.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
        }

        /* --- 标题样式 --- */
        h1 {
            font-size: 2rem;
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        h2 {
            font-size: 1.5rem;
            color: #34495e;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #3498db;
            padding-left: 1rem;
        }

        /* --- 段落和内联代码样式 --- */
        p {
            font-size: 1rem;
            color: #555;
            margin-bottom: 1rem;
        }

        code {
            font-family: 'Fira Code', 'Consolas', 'Monaco', 'monospace';
            background-color: #ecf0f1;
            color: #c0392b;
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
        }

        /* --- 代码块样式 --- */
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.95rem;
            line-height: 1.5;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
            border-radius: 0;
            font-size: inherit;
        }

        /* --- 代码高亮 --- */
        .code-comment { color: #7f8c8d; font-style: italic; }
        .code-key { color: #f92672; }
        .code-string { color: #a6e22e; }
        .code-value { color: #ae81ff; }
        .code-func { color: #66d9ef; }
        .code-macro { color: #e6db74; }

    </style>
</head>
<body>

    <div class="container">
        <h1>问题分析 语法示例</h1>

        <section id="retranslkeys">
            <h2>retranslKeys 语法示例</h2>
            <p>
                这是一个正则表达式列表。如果句子缓存中的某条 <code>problem</code> 能被以下任一正则 <code>search</code> 通过，则会进行重翻。
            </p>
            <p>
                如果想对指定原文/译文进行重翻，请通过内联表(数组)指定 <code>conditionTarget</code> 和 <code>conditionReg</code>。
            </p>
            <p>
                也可以指定 <code>conditionScript</code> 和 <code>conditionFunc</code> 来外接 lua/py 脚本 (<code>conditionFunc</code> 接收 Sentence，返回 bool)。
            </p>
            <p>
                <code>&lt;PROJECT_DIR&gt;</code> 是一个代表当前项目路径字符串的宏。
            </p>
            <p>
                <code>conditionTarget</code> 加前缀 <code>prev_</code> 或 <code>next_</code> 可表示前/后句，如 <code>prev_prev_orig_text</code> 表示上上句原文，如果不存在则条件失败。
            </p>
            <pre><code class="language-toml"><span class="code-key">retranslKeys</span> = [
  <span class="code-comment">#[{ conditionScript='&lt;PROJECT_DIR&gt;/Lua/MySampleTextPlugin.lua',conditionFunc='funcName'},</span>
  <span class="code-comment">#{ conditionScript='&lt;PROJECT_DIR&gt;/Python/MySampleTextPlugin.py',conditionFunc='funcName'}],</span>
  <span class="code-string">"残留日文"</span>,
  <span class="code-string">"翻译失败"</span>, <span class="code-comment"># 等效于 [{ conditionTarget = 'problems', conditionReg = '翻译失败' }]</span>
]</code></pre>
        </section>

        <section id="skipproblems">
            <h2>skipProblems 语法示例</h2>
            <p>
                这是一个正则表达式列表。如果一条 <code>problem</code> 能被以下任一正则 <code>search</code> 通过，则不会被加入 <code>problems</code> 列表。
            </p>
            <p>
                如果想忽略指定原文/译文的特定问题，请通过内联表(数组)来定义条件。表数组的第一项是要忽略的 <code>problem</code> (同样也是正则表达式)。
            </p>
            <pre><code class="language-toml"><span class="code-key">skipProblems</span> = [
  <span class="code-comment"># "^引入拉丁字母: Live$"  # 不加任何条件</span>
  <span class="code-comment"># 如果 原文中包含'モチモチ'且译文中包含'Q弹'，则忽略此句子中所有能被 '引入拉丁字母' search 通过的 problem</span>
  [ <span class="code-string">'引入拉丁字母'</span>, { <span class="code-key">conditionTarget</span> = <span class="code-string">'preproc_text'</span>, <span class="code-key">conditionReg</span> = <span class="code-string">'モチモチ'</span>},
    { <span class="code-key">conditionTarget</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">conditionReg</span> = <span class="code-string">'Q弹'</span>}],
]</code></pre>
        </section>

        <section id="overwritecompareobj">
            <h2>问题比较对象设定 语法示例</h2>
            <p>
                此配置用于指定不同问题检查时所使用的比较源（<code>base</code>）和检查目标（<code>check</code>）。
            </p>
            <pre><code class="language-toml"><span class="code-key">overwriteCompareObj</span> = [
    { <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'残留日文'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'preproc_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'标点错漏'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'preproc_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'引入拉丁字母'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'preproc_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'引入韩文'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'orig_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'丢失换行'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'orig_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'多加换行'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'preproc_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'字典未使用'</span> },
    { <span class="code-key">base</span> = <span class="code-string">'preproc_text'</span>, <span class="code-key">check</span> = <span class="code-string">'trans_preview'</span>, <span class="code-key">problemKey</span> = <span class="code-string">'语言不通'</span> }
]</code></pre>
            <p>
                例如，<code>{ problemKey = '比原文长严格', base = 'orig_text', check = 'trans_preview' }</code> 的意思是：当 <code>trans_preview</code> 比 <code>orig_text</code> 严格长时，在 <code>problem</code> 中留下对应的问题。
            </p>
        </section>

    </div>

</body>
</html>
